import { ChangeDetectionStrategy, Component, ViewEncapsulation } from '@angular/core';
import { SmartComponent } from '../../../../../feature/common/src/cdk/component/lib/src/smart-component';
import { StructureInfoModalComponent } from './info-modal/structure-info-modal.component';
import { useReactiveContext } from '../../../../../feature/common/src/cdk/component/lib';
import * as i0 from "@angular/core";
import * as i1 from "../../../../../core/structure/source/src/api/source.warehouse";
import * as i2 from "@generic-ui/fabric";
import * as i3 from "../../../../../core/composition/src/api/global/composition.id";
import * as i4 from "../../../../../core/structure/structure-core/src/api/global/structure.id";
import * as i5 from "../../../../../core/schema/src/api/global/schema.read-model-root-id";
import * as i6 from "../../column-manager/dialog/structure.dialog-column-manager.service";
import * as i7 from "../../../../../core/l10n/src/api/translation.facade";
import * as i8 from "../../../../../feature/schema/src/manager/dialog/structure.dialog-schema-manager.service";
import * as i9 from "../../../../../core/structure/structure-core/src/api/panel/info/structure.info-panel.archive";
import * as i10 from "@angular/common";
import * as i11 from "../../column-manager/icon/structure.column-manager-icon.component";
import * as i12 from "../../../../../feature/schema/src/manager/manager-icon/structure.schema-manager-icon.component";
import * as i13 from "../../../../../feature/structure/source/src/counter/filter/active-filter-menu-trigger.directive";
import * as i14 from "./icon/structure.info-icon.component";
import * as i15 from "../../../../../feature/common/src/cdk/number-formatter/number-formatter.pipe";
import * as i16 from "../../../../../feature/l10n/translation.pipe";
export class StructureInfoPanelComponent extends SmartComponent {
    constructor(changeDetectorRef, elementRef, injector, sourceWarehouse, dialog, compositionId, structureId, schemaReadModelRootId, menuColumnManagerService, translationService, schemaManagerService, structureInfoPanelArchive) {
        super(changeDetectorRef, elementRef);
        this.changeDetectorRef = changeDetectorRef;
        this.injector = injector;
        this.sourceWarehouse = sourceWarehouse;
        this.dialog = dialog;
        this.compositionId = compositionId;
        this.structureId = structureId;
        this.schemaReadModelRootId = schemaReadModelRootId;
        this.menuColumnManagerService = menuColumnManagerService;
        this.translationService = translationService;
        this.schemaManagerService = schemaManagerService;
        this.structureInfoPanelArchive = structureInfoPanelArchive;
        this.infoModal = StructureInfoModalComponent;
        this.context = useReactiveContext();
    }
    ngOnInit() {
        useReactiveContext(this.structureInfoPanelArchive.on(), this.changeDetectorRef)
            .subscribeAndRender((infoPanel) => {
            this.infoPanelConfig = infoPanel;
        });
        this.context
            .connect(this.sourceWarehouse.onOriginSize(this.structureId))
            .subscribeAndRender((size) => {
            this.totalItemsSize = size;
        });
        this.context
            .connect(this.sourceWarehouse.onPreparedItems(this.structureId))
            .subscribeAndRender((preparedItems) => {
            this.preparedItemsSize = preparedItems.length;
        });
        useReactiveContext(this.translationService.onTranslation(), this.changeDetectorRef)
            .subscribeAndRender((translation) => {
            this.themeManagerTooltipText = translation.infoPanelThemeMangerTooltipText;
            this.columnManagerTooltipText = translation.infoPanelColumnManagerTooltipText;
            this.infoTooltipText = translation.infoPanelInfoTooltipText;
        });
    }
    openInfo() {
        this.dialog.open({ component: this.infoModal });
    }
    openColumnManager() {
        this.menuColumnManagerService.open(this.compositionId, this.schemaReadModelRootId, this.injector);
    }
    openSchemaManager() {
        this.schemaManagerService.open(this.schemaReadModelRootId, this.injector);
    }
    getSelectorName() {
        return 'gui-structure-info-panel';
    }
}
StructureInfoPanelComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.0.2", ngImport: i0, type: StructureInfoPanelComponent, deps: [{ token: i0.ChangeDetectorRef }, { token: i0.ElementRef }, { token: i0.Injector }, { token: i1.SourceWarehouse }, { token: i2.FabricDialogService }, { token: i3.CompositionId }, { token: i4.StructureId }, { token: i5.SchemaReadModelRootId }, { token: i6.StructureDialogColumnManagerService }, { token: i7.TranslationFacade }, { token: i8.StructureDialogSchemaManagerService }, { token: i9.StructureInfoPanelArchive }], target: i0.ɵɵFactoryTarget.Component });
StructureInfoPanelComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.0.2", type: StructureInfoPanelComponent, selector: "div[gui-structure-info-panel]", usesInheritance: true, ngImport: i0, template: "<div>\n\t<div *ngIf=\"infoPanelConfig.isSourceSizeEnabled()\">\n\t\t<ng-container *ngIf=\"preparedItemsSize !== undefined && totalItemsSize !== undefined\">\n\n\t\t\t<ng-container *ngIf=\"preparedItemsSize === totalItemsSize\">\n\t\t\t\t{{'infoPanelShowing' | guiTranslate}}\n\t\t\t\t<b>{{totalItemsSize | numberFormatter}}</b>\n\t\t\t\t{{'infoPanelItems' | guiTranslate}}\n\t\t\t</ng-container>\n\n\t\t\t<span *ngIf=\"preparedItemsSize !== totalItemsSize\"\n\t\t\t\t  gui-active-filter-menu-trigger>\n\t\t\t\t\t\t{{'infoPanelShowing' | guiTranslate}}\n\t\t\t\t<b>{{preparedItemsSize | numberFormatter}}</b>\n\t\t\t\t{{'infoPanelOutOf' | guiTranslate}}\n\t\t\t\t<b>{{totalItemsSize | numberFormatter}}</b>\n\t\t\t\t{{'infoPanelItems' | guiTranslate}}\n\t\t\t</span>\n\n\t\t</ng-container>\n\n\t</div>\n</div>\n\n<div>\n\t<div class=\"gui-right-section\">\n\n\t\t<div (click)=\"openSchemaManager()\"\n\t\t\t *ngIf=\"infoPanelConfig.isSchemaManagerEnabled()\">\n\t\t\t<div [gui-tooltip]=\"themeManagerTooltipText\" gui-structure-schema-manager-icon></div>\n\t\t</div>\n\n\t\t<div (click)=\"openColumnManager()\"\n\t\t\t *ngIf=\"infoPanelConfig.isColumnsManagerEnabled()\">\n\t\t\t<div [gui-tooltip]=\"columnManagerTooltipText\" gui-structure-column-manager-icon></div>\n\t\t</div>\n\n\t\t<div (click)=\"openInfo()\"\n\t\t\t *ngIf=\"infoPanelConfig.isInfoDialogEnabled()\">\n\t\t\t<div [gui-tooltip]=\"infoTooltipText\" gui-structure-info-icon></div>\n\t\t</div>\n\t</div>\n</div>\n", dependencies: [{ kind: "directive", type: i10.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i2.FabricTooltipDirective, selector: "[gui-tooltip]", inputs: ["gui-tooltip"], exportAs: ["guiTooltip"] }, { kind: "component", type: i11.StructureColumnManagerIconComponent, selector: "div[gui-structure-column-manager-icon]" }, { kind: "component", type: i12.StructureSchemaManagerIconComponent, selector: "div[gui-structure-schema-manager-icon]" }, { kind: "directive", type: i13.ActiveFilterMenuTriggerDirective, selector: "[gui-active-filter-menu-trigger]" }, { kind: "component", type: i14.StructureInfoIconComponent, selector: "div[gui-structure-info-icon]" }, { kind: "pipe", type: i15.NumberFormatterPipe, name: "numberFormatter" }, { kind: "pipe", type: i16.TranslationPipe, name: "guiTranslate" }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.0.2", ngImport: i0, type: StructureInfoPanelComponent, decorators: [{
            type: Component,
            args: [{ selector: 'div[gui-structure-info-panel]', changeDetection: ChangeDetectionStrategy.OnPush, encapsulation: ViewEncapsulation.None, template: "<div>\n\t<div *ngIf=\"infoPanelConfig.isSourceSizeEnabled()\">\n\t\t<ng-container *ngIf=\"preparedItemsSize !== undefined && totalItemsSize !== undefined\">\n\n\t\t\t<ng-container *ngIf=\"preparedItemsSize === totalItemsSize\">\n\t\t\t\t{{'infoPanelShowing' | guiTranslate}}\n\t\t\t\t<b>{{totalItemsSize | numberFormatter}}</b>\n\t\t\t\t{{'infoPanelItems' | guiTranslate}}\n\t\t\t</ng-container>\n\n\t\t\t<span *ngIf=\"preparedItemsSize !== totalItemsSize\"\n\t\t\t\t  gui-active-filter-menu-trigger>\n\t\t\t\t\t\t{{'infoPanelShowing' | guiTranslate}}\n\t\t\t\t<b>{{preparedItemsSize | numberFormatter}}</b>\n\t\t\t\t{{'infoPanelOutOf' | guiTranslate}}\n\t\t\t\t<b>{{totalItemsSize | numberFormatter}}</b>\n\t\t\t\t{{'infoPanelItems' | guiTranslate}}\n\t\t\t</span>\n\n\t\t</ng-container>\n\n\t</div>\n</div>\n\n<div>\n\t<div class=\"gui-right-section\">\n\n\t\t<div (click)=\"openSchemaManager()\"\n\t\t\t *ngIf=\"infoPanelConfig.isSchemaManagerEnabled()\">\n\t\t\t<div [gui-tooltip]=\"themeManagerTooltipText\" gui-structure-schema-manager-icon></div>\n\t\t</div>\n\n\t\t<div (click)=\"openColumnManager()\"\n\t\t\t *ngIf=\"infoPanelConfig.isColumnsManagerEnabled()\">\n\t\t\t<div [gui-tooltip]=\"columnManagerTooltipText\" gui-structure-column-manager-icon></div>\n\t\t</div>\n\n\t\t<div (click)=\"openInfo()\"\n\t\t\t *ngIf=\"infoPanelConfig.isInfoDialogEnabled()\">\n\t\t\t<div [gui-tooltip]=\"infoTooltipText\" gui-structure-info-icon></div>\n\t\t</div>\n\t</div>\n</div>\n" }]
        }], ctorParameters: function () { return [{ type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.Injector }, { type: i1.SourceWarehouse }, { type: i2.FabricDialogService }, { type: i3.CompositionId }, { type: i4.StructureId }, { type: i5.SchemaReadModelRootId }, { type: i6.StructureDialogColumnManagerService }, { type: i7.TranslationFacade }, { type: i8.StructureDialogSchemaManagerService }, { type: i9.StructureInfoPanelArchive }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RydWN0dXJlLmluZm8tcGFuZWwuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vYnVpbGQtY2xpL3Byb2plY3RzL25neC1ncmlkL3NyYy9mZWF0dXJlLXZpZXcvZ3JpZC12aWV3L3NyYy9wYW5lbC9pbmZvL3N0cnVjdHVyZS5pbmZvLXBhbmVsLmNvbXBvbmVudC50cyIsIi4uLy4uLy4uLy4uLy4uLy4uLy4uL2J1aWxkLWNsaS9wcm9qZWN0cy9uZ3gtZ3JpZC9zcmMvZmVhdHVyZS12aWV3L2dyaWQtdmlldy9zcmMvcGFuZWwvaW5mby9zdHJ1Y3R1cmUuaW5mby1wYW5lbC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsdUJBQXVCLEVBQXFCLFNBQVMsRUFBZ0MsaUJBQWlCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFJdkksT0FBTyxFQUFFLGNBQWMsRUFBRSxNQUFNLHlFQUF5RSxDQUFDO0FBRXpHLE9BQU8sRUFBRSwyQkFBMkIsRUFBRSxNQUFNLDZDQUE2QyxDQUFDO0FBYTFGLE9BQU8sRUFBRSxrQkFBa0IsRUFBRSxNQUFNLHFEQUFxRCxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFTekYsTUFBTSxPQUFPLDJCQUE0QixTQUFRLGNBQWM7SUFvQjlELFlBQTZCLGlCQUFvQyxFQUM5RCxVQUFzQixFQUNMLFFBQWtCLEVBQ2xCLGVBQWdDLEVBQ2hDLE1BQTJCLEVBQzNCLGFBQTRCLEVBQzVCLFdBQXdCLEVBQ3hCLHFCQUE0QyxFQUM1Qyx3QkFBNkQsRUFDN0Qsa0JBQXFDLEVBQ3JDLG9CQUF5RCxFQUN6RCx5QkFBb0Q7UUFDdkUsS0FBSyxDQUFDLGlCQUFpQixFQUFFLFVBQVUsQ0FBQyxDQUFDO1FBWlQsc0JBQWlCLEdBQWpCLGlCQUFpQixDQUFtQjtRQUU3QyxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ2xCLG9CQUFlLEdBQWYsZUFBZSxDQUFpQjtRQUNoQyxXQUFNLEdBQU4sTUFBTSxDQUFxQjtRQUMzQixrQkFBYSxHQUFiLGFBQWEsQ0FBZTtRQUM1QixnQkFBVyxHQUFYLFdBQVcsQ0FBYTtRQUN4QiwwQkFBcUIsR0FBckIscUJBQXFCLENBQXVCO1FBQzVDLDZCQUF3QixHQUF4Qix3QkFBd0IsQ0FBcUM7UUFDN0QsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFtQjtRQUNyQyx5QkFBb0IsR0FBcEIsb0JBQW9CLENBQXFDO1FBQ3pELDhCQUF5QixHQUF6Qix5QkFBeUIsQ0FBMkI7UUF2QnhFLGNBQVMsR0FBRywyQkFBMkIsQ0FBQztRQVV4QyxZQUFPLEdBQUcsa0JBQWtCLEVBQUUsQ0FBQztJQWUvQixDQUFDO0lBRUQsUUFBUTtRQUVQLGtCQUFrQixDQUFDLElBQUksQ0FBQyx5QkFBeUIsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLENBQUMsaUJBQWlCLENBQUM7YUFDN0Usa0JBQWtCLENBQUMsQ0FBQyxTQUFtQyxFQUFFLEVBQUU7WUFDM0QsSUFBSSxDQUFDLGVBQWUsR0FBRyxTQUFTLENBQUM7UUFDbEMsQ0FBQyxDQUFDLENBQUM7UUFFSixJQUFJLENBQUMsT0FBTzthQUNWLE9BQU8sQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7YUFDNUQsa0JBQWtCLENBQUMsQ0FBQyxJQUFZLEVBQUUsRUFBRTtZQUNwQyxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztRQUM1QixDQUFDLENBQUMsQ0FBQztRQUVKLElBQUksQ0FBQyxPQUFPO2FBQ1YsT0FBTyxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQzthQUMvRCxrQkFBa0IsQ0FBQyxDQUFDLGFBQWdDLEVBQUUsRUFBRTtZQUN4RCxJQUFJLENBQUMsaUJBQWlCLEdBQUcsYUFBYSxDQUFDLE1BQU0sQ0FBQztRQUMvQyxDQUFDLENBQUMsQ0FBQztRQUVKLGtCQUFrQixDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxhQUFhLEVBQUUsRUFBRSxJQUFJLENBQUMsaUJBQWlCLENBQUM7YUFDakYsa0JBQWtCLENBQUMsQ0FBQyxXQUF3QixFQUFFLEVBQUU7WUFDaEQsSUFBSSxDQUFDLHVCQUF1QixHQUFHLFdBQVcsQ0FBQywrQkFBK0IsQ0FBQztZQUMzRSxJQUFJLENBQUMsd0JBQXdCLEdBQUcsV0FBVyxDQUFDLGlDQUFpQyxDQUFDO1lBQzlFLElBQUksQ0FBQyxlQUFlLEdBQUcsV0FBVyxDQUFDLHdCQUF3QixDQUFDO1FBQzdELENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELFFBQVE7UUFDUCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLFNBQVMsRUFBRSxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBRUQsaUJBQWlCO1FBQ2hCLElBQUksQ0FBQyx3QkFBd0IsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ25HLENBQUM7SUFFRCxpQkFBaUI7UUFDaEIsSUFBSSxDQUFDLG9CQUFvQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzNFLENBQUM7SUFFUyxlQUFlO1FBQ3hCLE9BQU8sMEJBQTBCLENBQUM7SUFDbkMsQ0FBQzs7d0hBNUVXLDJCQUEyQjs0R0FBM0IsMkJBQTJCLDRGQzVCeEMseThDQTJDQTsyRkRmYSwyQkFBMkI7a0JBTnZDLFNBQVM7K0JBQ0MsK0JBQStCLG1CQUV4Qix1QkFBdUIsQ0FBQyxNQUFNLGlCQUNoQyxpQkFBaUIsQ0FBQyxJQUFJIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksIENoYW5nZURldGVjdG9yUmVmLCBDb21wb25lbnQsIEVsZW1lbnRSZWYsIEluamVjdG9yLCBPbkluaXQsIFZpZXdFbmNhcHN1bGF0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IEZhYnJpY0RpYWxvZ1NlcnZpY2UgfSBmcm9tICdAZ2VuZXJpYy11aS9mYWJyaWMnO1xuXG5pbXBvcnQgeyBTbWFydENvbXBvbmVudCB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2ZlYXR1cmUvY29tbW9uL3NyYy9jZGsvY29tcG9uZW50L2xpYi9zcmMvc21hcnQtY29tcG9uZW50JztcblxuaW1wb3J0IHsgU3RydWN0dXJlSW5mb01vZGFsQ29tcG9uZW50IH0gZnJvbSAnLi9pbmZvLW1vZGFsL3N0cnVjdHVyZS1pbmZvLW1vZGFsLmNvbXBvbmVudCc7XG5cbmltcG9ydCB7IFNvdXJjZVdhcmVob3VzZSB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2NvcmUvc3RydWN0dXJlL3NvdXJjZS9zcmMvYXBpL3NvdXJjZS53YXJlaG91c2UnO1xuaW1wb3J0IHsgU3RydWN0dXJlRGlhbG9nQ29sdW1uTWFuYWdlclNlcnZpY2UgfSBmcm9tICcuLi8uLi9jb2x1bW4tbWFuYWdlci9kaWFsb2cvc3RydWN0dXJlLmRpYWxvZy1jb2x1bW4tbWFuYWdlci5zZXJ2aWNlJztcbmltcG9ydCB7IENvbXBvc2l0aW9uSWQgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9jb3JlL2NvbXBvc2l0aW9uL3NyYy9hcGkvZ2xvYmFsL2NvbXBvc2l0aW9uLmlkJztcbmltcG9ydCB7IFN0cnVjdHVyZUlkIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vY29yZS9zdHJ1Y3R1cmUvc3RydWN0dXJlLWNvcmUvc3JjL2FwaS9nbG9iYWwvc3RydWN0dXJlLmlkJztcbmltcG9ydCB7IFNjaGVtYVJlYWRNb2RlbFJvb3RJZCB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2NvcmUvc2NoZW1hL3NyYy9hcGkvZ2xvYmFsL3NjaGVtYS5yZWFkLW1vZGVsLXJvb3QtaWQnO1xuaW1wb3J0IHsgU3RydWN0dXJlSW5mb1BhbmVsQXJjaGl2ZSB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2NvcmUvc3RydWN0dXJlL3N0cnVjdHVyZS1jb3JlL3NyYy9hcGkvcGFuZWwvaW5mby9zdHJ1Y3R1cmUuaW5mby1wYW5lbC5hcmNoaXZlJztcbmltcG9ydCB7IFN0cnVjdHVyZUluZm9QYW5lbENvbmZpZyB9IGZyb20gJy4uLy4uLy4uLy4uLy4uL2NvcmUvc3RydWN0dXJlL3N0cnVjdHVyZS1jb3JlL3NyYy9hcGkvcGFuZWwvaW5mby9zdHJ1Y3R1cmUuaW5mby1wYW5lbC5jb25maWcnO1xuaW1wb3J0IHsgU3RydWN0dXJlRGlhbG9nU2NoZW1hTWFuYWdlclNlcnZpY2UgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9mZWF0dXJlL3NjaGVtYS9zcmMvbWFuYWdlci9kaWFsb2cvc3RydWN0dXJlLmRpYWxvZy1zY2hlbWEtbWFuYWdlci5zZXJ2aWNlJztcbmltcG9ydCB7IEl0ZW1FbnRpdHkgfSBmcm9tICcuLi8uLi8uLi8uLi8uLi9jb3JlL3N0cnVjdHVyZS9zb3VyY2Uvc3JjL2RvbWFpbi9pdGVtL2l0ZW0uZW50aXR5JztcbmltcG9ydCB7IFRyYW5zbGF0aW9uRmFjYWRlIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vY29yZS9sMTBuL3NyYy9hcGkvdHJhbnNsYXRpb24uZmFjYWRlJztcbmltcG9ydCB7IFRyYW5zbGF0aW9uIH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vY29yZS9sMTBuL3NyYy9hcGkvdHJhbnNsYXRpb24nO1xuaW1wb3J0IHsgdXNlUmVhY3RpdmVDb250ZXh0IH0gZnJvbSAnLi4vLi4vLi4vLi4vLi4vZmVhdHVyZS9jb21tb24vc3JjL2Nkay9jb21wb25lbnQvbGliJztcblxuXG5AQ29tcG9uZW50KHtcblx0c2VsZWN0b3I6ICdkaXZbZ3VpLXN0cnVjdHVyZS1pbmZvLXBhbmVsXScsXG5cdHRlbXBsYXRlVXJsOiAnLi9zdHJ1Y3R1cmUuaW5mby1wYW5lbC5jb21wb25lbnQuaHRtbCcsXG5cdGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuXHRlbmNhcHN1bGF0aW9uOiBWaWV3RW5jYXBzdWxhdGlvbi5Ob25lXG59KVxuZXhwb3J0IGNsYXNzIFN0cnVjdHVyZUluZm9QYW5lbENvbXBvbmVudCBleHRlbmRzIFNtYXJ0Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuXHR0b3RhbEl0ZW1zU2l6ZTogbnVtYmVyO1xuXG5cdHByZXBhcmVkSXRlbXNTaXplOiBudW1iZXI7XG5cblx0cm93SGVpZ2h0OiBudW1iZXI7XG5cblx0aW5mb01vZGFsID0gU3RydWN0dXJlSW5mb01vZGFsQ29tcG9uZW50O1xuXG5cdGluZm9QYW5lbENvbmZpZzogU3RydWN0dXJlSW5mb1BhbmVsQ29uZmlnO1xuXG5cdHRoZW1lTWFuYWdlclRvb2x0aXBUZXh0OiBzdHJpbmc7XG5cblx0Y29sdW1uTWFuYWdlclRvb2x0aXBUZXh0OiBzdHJpbmc7XG5cblx0aW5mb1Rvb2x0aXBUZXh0OiBzdHJpbmc7XG5cblx0Y29udGV4dCA9IHVzZVJlYWN0aXZlQ29udGV4dCgpO1xuXG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgY2hhbmdlRGV0ZWN0b3JSZWY6IENoYW5nZURldGVjdG9yUmVmLFxuXHRcdFx0XHRlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxuXHRcdFx0XHRwcml2YXRlIHJlYWRvbmx5IGluamVjdG9yOiBJbmplY3Rvcixcblx0XHRcdFx0cHJpdmF0ZSByZWFkb25seSBzb3VyY2VXYXJlaG91c2U6IFNvdXJjZVdhcmVob3VzZSxcblx0XHRcdFx0cHJpdmF0ZSByZWFkb25seSBkaWFsb2c6IEZhYnJpY0RpYWxvZ1NlcnZpY2UsXG5cdFx0XHRcdHByaXZhdGUgcmVhZG9ubHkgY29tcG9zaXRpb25JZDogQ29tcG9zaXRpb25JZCxcblx0XHRcdFx0cHJpdmF0ZSByZWFkb25seSBzdHJ1Y3R1cmVJZDogU3RydWN0dXJlSWQsXG5cdFx0XHRcdHByaXZhdGUgcmVhZG9ubHkgc2NoZW1hUmVhZE1vZGVsUm9vdElkOiBTY2hlbWFSZWFkTW9kZWxSb290SWQsXG5cdFx0XHRcdHByaXZhdGUgcmVhZG9ubHkgbWVudUNvbHVtbk1hbmFnZXJTZXJ2aWNlOiBTdHJ1Y3R1cmVEaWFsb2dDb2x1bW5NYW5hZ2VyU2VydmljZSxcblx0XHRcdFx0cHJpdmF0ZSByZWFkb25seSB0cmFuc2xhdGlvblNlcnZpY2U6IFRyYW5zbGF0aW9uRmFjYWRlLFxuXHRcdFx0XHRwcml2YXRlIHJlYWRvbmx5IHNjaGVtYU1hbmFnZXJTZXJ2aWNlOiBTdHJ1Y3R1cmVEaWFsb2dTY2hlbWFNYW5hZ2VyU2VydmljZSxcblx0XHRcdFx0cHJpdmF0ZSByZWFkb25seSBzdHJ1Y3R1cmVJbmZvUGFuZWxBcmNoaXZlOiBTdHJ1Y3R1cmVJbmZvUGFuZWxBcmNoaXZlKSB7XG5cdFx0c3VwZXIoY2hhbmdlRGV0ZWN0b3JSZWYsIGVsZW1lbnRSZWYpO1xuXHR9XG5cblx0bmdPbkluaXQoKSB7XG5cblx0XHR1c2VSZWFjdGl2ZUNvbnRleHQodGhpcy5zdHJ1Y3R1cmVJbmZvUGFuZWxBcmNoaXZlLm9uKCksIHRoaXMuY2hhbmdlRGV0ZWN0b3JSZWYpXG5cdFx0XHQuc3Vic2NyaWJlQW5kUmVuZGVyKChpbmZvUGFuZWw6IFN0cnVjdHVyZUluZm9QYW5lbENvbmZpZykgPT4ge1xuXHRcdFx0XHR0aGlzLmluZm9QYW5lbENvbmZpZyA9IGluZm9QYW5lbDtcblx0XHRcdH0pO1xuXG5cdFx0dGhpcy5jb250ZXh0XG5cdFx0XHQuY29ubmVjdCh0aGlzLnNvdXJjZVdhcmVob3VzZS5vbk9yaWdpblNpemUodGhpcy5zdHJ1Y3R1cmVJZCkpXG5cdFx0XHQuc3Vic2NyaWJlQW5kUmVuZGVyKChzaXplOiBudW1iZXIpID0+IHtcblx0XHRcdFx0dGhpcy50b3RhbEl0ZW1zU2l6ZSA9IHNpemU7XG5cdFx0XHR9KTtcblxuXHRcdHRoaXMuY29udGV4dFxuXHRcdFx0LmNvbm5lY3QodGhpcy5zb3VyY2VXYXJlaG91c2Uub25QcmVwYXJlZEl0ZW1zKHRoaXMuc3RydWN0dXJlSWQpKVxuXHRcdFx0LnN1YnNjcmliZUFuZFJlbmRlcigocHJlcGFyZWRJdGVtczogQXJyYXk8SXRlbUVudGl0eT4pID0+IHtcblx0XHRcdFx0dGhpcy5wcmVwYXJlZEl0ZW1zU2l6ZSA9IHByZXBhcmVkSXRlbXMubGVuZ3RoO1xuXHRcdFx0fSk7XG5cblx0XHR1c2VSZWFjdGl2ZUNvbnRleHQodGhpcy50cmFuc2xhdGlvblNlcnZpY2Uub25UcmFuc2xhdGlvbigpLCB0aGlzLmNoYW5nZURldGVjdG9yUmVmKVxuXHRcdFx0LnN1YnNjcmliZUFuZFJlbmRlcigodHJhbnNsYXRpb246IFRyYW5zbGF0aW9uKSA9PiB7XG5cdFx0XHRcdHRoaXMudGhlbWVNYW5hZ2VyVG9vbHRpcFRleHQgPSB0cmFuc2xhdGlvbi5pbmZvUGFuZWxUaGVtZU1hbmdlclRvb2x0aXBUZXh0O1xuXHRcdFx0XHR0aGlzLmNvbHVtbk1hbmFnZXJUb29sdGlwVGV4dCA9IHRyYW5zbGF0aW9uLmluZm9QYW5lbENvbHVtbk1hbmFnZXJUb29sdGlwVGV4dDtcblx0XHRcdFx0dGhpcy5pbmZvVG9vbHRpcFRleHQgPSB0cmFuc2xhdGlvbi5pbmZvUGFuZWxJbmZvVG9vbHRpcFRleHQ7XG5cdFx0XHR9KTtcblx0fVxuXG5cdG9wZW5JbmZvKCk6IHZvaWQge1xuXHRcdHRoaXMuZGlhbG9nLm9wZW4oeyBjb21wb25lbnQ6IHRoaXMuaW5mb01vZGFsIH0pO1xuXHR9XG5cblx0b3BlbkNvbHVtbk1hbmFnZXIoKTogdm9pZCB7XG5cdFx0dGhpcy5tZW51Q29sdW1uTWFuYWdlclNlcnZpY2Uub3Blbih0aGlzLmNvbXBvc2l0aW9uSWQsIHRoaXMuc2NoZW1hUmVhZE1vZGVsUm9vdElkLCB0aGlzLmluamVjdG9yKTtcblx0fVxuXG5cdG9wZW5TY2hlbWFNYW5hZ2VyKCk6IHZvaWQge1xuXHRcdHRoaXMuc2NoZW1hTWFuYWdlclNlcnZpY2Uub3Blbih0aGlzLnNjaGVtYVJlYWRNb2RlbFJvb3RJZCwgdGhpcy5pbmplY3Rvcik7XG5cdH1cblxuXHRwcm90ZWN0ZWQgZ2V0U2VsZWN0b3JOYW1lKCk6IHN0cmluZyB7XG5cdFx0cmV0dXJuICdndWktc3RydWN0dXJlLWluZm8tcGFuZWwnO1xuXHR9XG5cbn1cbiIsIjxkaXY+XG5cdDxkaXYgKm5nSWY9XCJpbmZvUGFuZWxDb25maWcuaXNTb3VyY2VTaXplRW5hYmxlZCgpXCI+XG5cdFx0PG5nLWNvbnRhaW5lciAqbmdJZj1cInByZXBhcmVkSXRlbXNTaXplICE9PSB1bmRlZmluZWQgJiYgdG90YWxJdGVtc1NpemUgIT09IHVuZGVmaW5lZFwiPlxuXG5cdFx0XHQ8bmctY29udGFpbmVyICpuZ0lmPVwicHJlcGFyZWRJdGVtc1NpemUgPT09IHRvdGFsSXRlbXNTaXplXCI+XG5cdFx0XHRcdHt7J2luZm9QYW5lbFNob3dpbmcnIHwgZ3VpVHJhbnNsYXRlfX1cblx0XHRcdFx0PGI+e3t0b3RhbEl0ZW1zU2l6ZSB8IG51bWJlckZvcm1hdHRlcn19PC9iPlxuXHRcdFx0XHR7eydpbmZvUGFuZWxJdGVtcycgfCBndWlUcmFuc2xhdGV9fVxuXHRcdFx0PC9uZy1jb250YWluZXI+XG5cblx0XHRcdDxzcGFuICpuZ0lmPVwicHJlcGFyZWRJdGVtc1NpemUgIT09IHRvdGFsSXRlbXNTaXplXCJcblx0XHRcdFx0ICBndWktYWN0aXZlLWZpbHRlci1tZW51LXRyaWdnZXI+XG5cdFx0XHRcdFx0XHR7eydpbmZvUGFuZWxTaG93aW5nJyB8IGd1aVRyYW5zbGF0ZX19XG5cdFx0XHRcdDxiPnt7cHJlcGFyZWRJdGVtc1NpemUgfCBudW1iZXJGb3JtYXR0ZXJ9fTwvYj5cblx0XHRcdFx0e3snaW5mb1BhbmVsT3V0T2YnIHwgZ3VpVHJhbnNsYXRlfX1cblx0XHRcdFx0PGI+e3t0b3RhbEl0ZW1zU2l6ZSB8IG51bWJlckZvcm1hdHRlcn19PC9iPlxuXHRcdFx0XHR7eydpbmZvUGFuZWxJdGVtcycgfCBndWlUcmFuc2xhdGV9fVxuXHRcdFx0PC9zcGFuPlxuXG5cdFx0PC9uZy1jb250YWluZXI+XG5cblx0PC9kaXY+XG48L2Rpdj5cblxuPGRpdj5cblx0PGRpdiBjbGFzcz1cImd1aS1yaWdodC1zZWN0aW9uXCI+XG5cblx0XHQ8ZGl2IChjbGljayk9XCJvcGVuU2NoZW1hTWFuYWdlcigpXCJcblx0XHRcdCAqbmdJZj1cImluZm9QYW5lbENvbmZpZy5pc1NjaGVtYU1hbmFnZXJFbmFibGVkKClcIj5cblx0XHRcdDxkaXYgW2d1aS10b29sdGlwXT1cInRoZW1lTWFuYWdlclRvb2x0aXBUZXh0XCIgZ3VpLXN0cnVjdHVyZS1zY2hlbWEtbWFuYWdlci1pY29uPjwvZGl2PlxuXHRcdDwvZGl2PlxuXG5cdFx0PGRpdiAoY2xpY2spPVwib3BlbkNvbHVtbk1hbmFnZXIoKVwiXG5cdFx0XHQgKm5nSWY9XCJpbmZvUGFuZWxDb25maWcuaXNDb2x1bW5zTWFuYWdlckVuYWJsZWQoKVwiPlxuXHRcdFx0PGRpdiBbZ3VpLXRvb2x0aXBdPVwiY29sdW1uTWFuYWdlclRvb2x0aXBUZXh0XCIgZ3VpLXN0cnVjdHVyZS1jb2x1bW4tbWFuYWdlci1pY29uPjwvZGl2PlxuXHRcdDwvZGl2PlxuXG5cdFx0PGRpdiAoY2xpY2spPVwib3BlbkluZm8oKVwiXG5cdFx0XHQgKm5nSWY9XCJpbmZvUGFuZWxDb25maWcuaXNJbmZvRGlhbG9nRW5hYmxlZCgpXCI+XG5cdFx0XHQ8ZGl2IFtndWktdG9vbHRpcF09XCJpbmZvVG9vbHRpcFRleHRcIiBndWktc3RydWN0dXJlLWluZm8taWNvbj48L2Rpdj5cblx0XHQ8L2Rpdj5cblx0PC9kaXY+XG48L2Rpdj5cbiJdfQ==